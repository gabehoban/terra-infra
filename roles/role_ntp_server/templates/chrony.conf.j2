{{ ansible_managed | comment }}
# Generated by Ansible role {{ ansible_role_name }}

#[-] Define directory locations [-]#
driftfile   /var/lib/chrony/chrony.drift
logdir      /var/log/chrony
ntsdumpdir  /var/lib/chrony

#[-] Collect statistics for calibration [-]#
log tracking measurements statistics
log rawmeasurements measurements statistics tracking refclocks tempcomp

#[-] General Chrony Configuration [-]#
# Lock processes to RAM to lower latency
lock_all
# Set maximum skew threshold for sources
maxupdateskew 100.0
# Set amount of ram allocated to logging client state 
clientloglimit 10000000
# Sync time to hardware clock
rtcsync
# Adjust clock if time differs by +/- 0.1 seconds
makestep 0.1 3
# Rate limit clients to ensure low latency
ratelimit interval 1 burst 16 leak 2 

#[-] Allow all client connections from internal nets [-]#
# DMZ
allow 192.168.1.0/24
# VLAN10 - Trusted
allow 10.32.10.0/24
# VLAN20 - Guest
allow 10.32.20.0/24
# VLAN30 - IOT
allow 10.32.30.0/24
# VLAN40 - Servers
allow 10.32.40.0/24
# VLAN50 - Video
allow 10.32.50.0/24
# Network QoS Code
dscp 48

#[-] Configure stratum 1 sources [-]#
refclock SHM 0 poll 8 refid NMEA offset 0.0339 precision 1e-3 poll 3 noselect
refclock PPS /dev/pps0 refid PPS lock NMEA maxlockage 2 poll 4 precision 1e-7 prefer

#[-] Public servers to set as initial time source [-]#
server time.apple.com iburst
server time.nist.gov iburst
server time.cloudflare.com iburst
